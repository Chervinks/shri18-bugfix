# Задание 1 — найди ошибки
[Постановка задачи и код](https://github.com/yandex-shri-2018/entrance-task-1-2)

(Задача описана в конце файла)

## Ход решения
##### 1. Подключение `initMap` в `index.js`
Несмотря на то, что модуль `map` экспортирует только одно значение, в нём не используется экспорт 
по умолчанию `default`, поэтому импорт `initMap` без фигурных скобок `{...}` некорректен. Корректный импорт:
```
import { initMap } from "./map";
```

##### 2. Нулевая высота `map`
После исправления первой ошибки карта инициализируется, но всё ещё не отображается. Это происходит из-за 
того, что не задана её высота. Т.к. в задании сказано, что карта должна занимать всю область экрана, проблема 
решается добавлением следующих строк кода в стиль для `#map`:
```
width: 100%;
height: 100%;
```

##### 3. `objectManager` не добавлен на карту
Создан `objectManager`, и ему заданы опции, однако он никак не связан с картой. Добавим его на карту, в
методе `loadList()` после закрузки данных:
```
myMap.geoObjects.add(objectManager);
```

##### 4. Широта и долгота перепутаны местами
В `mappers.js` некорректно передаются координаты, их нужно поменять местами. Правильный вариант:
```
coordinates: [obj.lat, obj.long]
```

##### 5. Стрелочные функции в `details.js` не имеют собственного `this`
Стрелочные функции лексически привязаны к значению `this`, но не привязаны к собственному `this` (`arguments`, `super`, или `new.target`). Однако, в теле функций `this` 
всё таки используется. Для корретной работы требуется заменить `() =>` на `function ()`.

##### 6. Нулевой максимум для оси Y в `chart.js`
Заменим 0 на новое значение - `limit`:
```
yAxes: [{ticks: {beginAtZero: true, max: limit}}]
```
и будем считать его, как максимальное число из `data`:
```
const limit = data.reduce(
  (accumulator, currentValue) => {
      return (accumulator > currentValue ? accumulator : currentValue);
  }
);
```

##### 7. Кластеры зелёные, даже если содержат неисправный объект
Перекрасим кластеры, если количество неисправных объектов кластера больше 0:
```
objectManager.clusters.events.add('add', function (e) {
  const cluster = objectManager.clusters.getById(e.get('objectId')),
      objects = cluster.properties.geoObjects;
      
   const defective = objects.filter(obj => !obj.isActive);
   
   if (defective.length) {
      objectManager.clusters.setClusterOptions(cluster.id, {
          preset: 'islands#redClusterIcons'
      });
  }
});
```
##### 8. Нефункциональные изменения

###### Замена `var`
Использование `var` не рекомендуется, т.к. имеет неограниченную область видимости, что
может послужить причиной возникновения множества ошибок. Заменим `var` на `const` в 
зависимости от семантики, чтобы защитить переменные от изменений из других частей кода.

###### Избыточное объявление `chart` в `chart.js`
Переменная `chart` имеет только одно использование в `return chart`, следовательно
можно заменить эту конструкцию без создания переменной:
```
return new Chart(ctx, {
    ...
});
```

## Постановка задачи

Представьте, что вы инженер в большом интернет-магазине и отвечаете за доставку заказов дронами.

В каждый момент времени в воздухе находится несколько сотен дронов. Для управления ими развёрнута сеть базовых станций. В ваших обязанностях — контроль работоспособности станций и устранение неисправностей. Для этого есть специальное приложение, в котором на карте города показаны места размещения базовых станций и информация о них.

К сожалению, после очередного релиза вашего приложения данные на карте перестали отображаться. Кажется, программисты опять понаделали ошибок в коде. Нужно скорее найти ошибки и починить их.

##### Описание
* Всю область экрана занимает интерактивная карта Москвы.
* На карте отображаются места размещения базовых станций.
    * Если на небольшом пространстве много объектов, они объединяются в кластер. 
    * При клике на кластер карта масштабируется для просмотра объектов, входящих в него.
* Неисправные станции обозначаются на карте красным цветом, исправные — синим.
    * Используя фильтр, можно отобразить на карте объекты с нужным состоянием — например, отобразить только неисправные. 
    * Если неисправный объект входит в кластер, то иконка кластера должна показывать, что в нем есть неисправная станция.
* При клике на метку базовой станции появляется попап с информацией о ней: серийный номер, состояние, количество активных дронов, график нагрузки.

##### Техническое описание
* Приложение работает в браузере и написано на JavaScript, модули собираются с помощью Webpack.
* Для отображения карты используется API Яндекс.Карт.
* Для для отображения графиков используется Chart.js.

##### Запуск
```
npm i 
npm start
 ```
 
###### Что мы проверяем этим заданием

В этом задании мы хотим проверить вашу способность разбираться в незнакомом коде и API, а также ваш навык отладки. Пожалуйста, опишите в коде или файле README ход ваших мыслей: как и какие ошибки вы нашли, почему они возникли, какие существуют способы их исправления. Мы не ограничиваем вас в использовании сторонних инструментов и библиотек, но будем ждать от вас комментария — что и зачем вы использовали.